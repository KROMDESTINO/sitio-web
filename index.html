<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#667eea">
  <title>¡Apúntate a Partidas de Juegos de Mesa!</title>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icon-192x192.png">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    /* Manteniendo todo el CSS original */
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

    body {
        font-family: 'Poppins', sans-serif;
        margin: 0;
        padding: 0;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 800 800"><defs><pattern id="dicePattern" patternUnits="userSpaceOnUse" width="100" height="100"><circle cx="50" cy="50" r="20" fill="%23ffffff22"/><circle cx="50" cy="50" r="5" fill="%23ffffff44"/></pattern></defs><rect width="100%" height="100%" fill="%23667eea"/><rect width="100%" height="100%" fill="url(%23dicePattern)"/></svg>') no-repeat center center fixed;
        background-size: cover;
    }

    .container {
        background-color: rgba(255, 255, 255, 0.9);
        border-radius: 20px;
        box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
        padding: 20px;
        width: 90%;
        max-width: 1000px;
    }

    #clubLogo {
        display: block;
        max-width: 100%;
        height: auto;
        margin: 0 auto 20px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    @media (min-width: 768px) {
        #clubLogo {
            max-width: 300px;
        }
    }

    h1 {
        color: #4a4a4a;
        text-align: center;
        margin-bottom: 30px;
        font-size: 2.2em;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    }

    /* Aquí van todos los demás estilos originales de tu código */

  </style>
</head>
<body>
  <div class="container">
    <img src="/a/cdaf20ad-c9d1-42cb-a2d5-3740947188b1" alt="Logo del club de juegos de mesa" id="clubLogo">
    <h1>🎲 ¡Apúntate a Partidas de Juegos de Mesa! 🎲</h1>
    <button id="toggleStats" onclick="toggleStatsDisplay()">Info</button>

    <!-- Continuación de tu contenido HTML, como secciones de días, propuestas de juegos, actividades, etc. -->
  </div>

  <!-- Script para Firebase y funciones de manejo de datos -->
  <script type="module">
    // Importar las funciones necesarias del SDK de Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, updateDoc, deleteDoc, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";

    // Configuración de Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyDxqAMsDpuzsGNcZzK1d74ucvIV4bfAOE",
      authDomain: "juegos-de-mesa-9d7ef.firebaseapp.com",
      databaseURL: "https://juegos-de-mesa-9d7ef-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "juegos-de-mesa-9d7ef",
      storageBucket: "juegos-de-mesa-9d7ef.appspot.com",
      messagingSenderId: "289986562577",
      appId: "1:289986562577:web:02878f48c9154cebf8b0"
    };

    // Inicializar Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Función para agregar un jugador a Firestore
    async function addPlayer(day) {
      const nameInput = document.getElementById(`${day}Name`).value;
      const timeSelect = document.getElementById(`${day}Time`).value;
      const munchisRadios = document.getElementsByName(`${day}Munchis`);
      let munchisChoice = Array.from(munchisRadios).find(radio => radio.checked).value;

      if (nameInput === '' || timeSelect === '') {
        alert('Por favor, completa todos los campos.');
        return;
      }

      try {
        await addDoc(collection(db, "players"), {
          name: nameInput,
          time: timeSelect,
          munchis: munchisChoice,
          day: day
        });
        alert('Jugador registrado exitosamente!');
        getPlayers(); // Actualizar la lista de jugadores después de agregar
      } catch (error) {
        console.error('Error al registrar jugador:', error);
      }
    }

    // Función para escuchar cambios en tiempo real en Firestore
    function getPlayers() {
      const listaJugadores = document.getElementById('lista-jugadores');
      onSnapshot(collection(db, "players"), (snapshot) => {
        listaJugadores.innerHTML = '';
        snapshot.forEach((doc) => {
          const jugador = doc.data();
          const li = document.createElement('li');
          li.textContent = `${jugador.name} - ${jugador.day} - ${jugador.time}`;
          li.innerHTML += ` <button onclick="deletePlayer('${doc.id}')">Eliminar</button> 
                            <button onclick="editPlayer('${doc.id}')">Editar</button>`;
          listaJugadores.appendChild(li);
        });
      });
    }

    // Funciones para eliminar, editar y actualizar jugadores
    async function deletePlayer(id) {
      try {
        await deleteDoc(doc(db, "players", id));
        alert('Jugador eliminado correctamente!');
        getPlayers(); // Actualizar la lista de jugadores después de eliminar
      } catch (error) {
        console.error('Error al eliminar jugador:', error);
      }
    }

    function editPlayer(id) {
      const nombre = prompt('Nuevo nombre:');
      const dia = prompt('Nuevo día (YYYY-MM-DD):');
      const hora = prompt('Nueva hora (HH:MM):');

      if (nombre && dia && hora) {
        updatePlayer(id, { nombre, dia, hora });
      }
    }

    async function updatePlayer(id, newData) {
      try {
        const playerRef = doc(db, "players", id);
        await updateDoc(playerRef, newData);
        alert('Jugador actualizado correctamente!');
        getPlayers(); // Actualizar la lista de jugadores después de actualizar
      } catch (error) {
        console.error('Error al actualizar jugador:', error);
      }
    }

    // Función para manejar cambios en las fechas
    function updateDates() {
      console.log('Función updateDates llamada');
      // Lógica para manejar cambios en las fechas
    }

    // Llamar a getPlayers al cargar la página para mostrar los jugadores existentes
    window.onload = function() {
      getPlayers();
    }
  </script>

  <!-- Mantener otros scripts personalizados -->
  <script>
    // Todo el resto de tus scripts personalizados que manejan la lógica específica de tu aplicación
    // Manteniendo toda la funcionalidad original y el aspecto de los botones, formularios, etc.
  </script>

  <div class="dice-animation dice-1"></div>
  <div class="dice-animation dice-2"></div>
  <div class="dice-animation dice-3"></div>
</body>
</html>

